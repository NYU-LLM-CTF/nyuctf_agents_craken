# twin
> The twins Alice and Bob are so close that they share everything, even the modulus of their RSA keys.

## About the Challenge
We were given a zip file (you can get the source code [here](twin.zip)), and inside the file, there are four files. The first file is named `cipher`, which contains ciphertext. There is also a file named `chall.py` that contains a Python script to encrypt the flag, as well as two files named `key1.pem` and `key2.pem`, which are RSA public keys.

## How to Solve?
If we check on the `chall.py`

```python
from Crypto.PublicKey import RSA
from Crypto.Util.number import bytes_to_long
from binascii import hexlify

from secret import flag

key1 = RSA.import_key(open('key1.pem','rb').read())
key2 = RSA.import_key(open('key2.pem','rb').read())

c1 = pow(bytes_to_long(flag), key1.e, key1.n)
c2 = pow(bytes_to_long(flag), key2.e, key2.n)

writer = open('ciphers','w')
writer.write('%d\n%d' % (c1, c2))
writer.close()
```

The script reads in two RSA keys from files named `key1.pem` and `key2.pem`. And then the script then uses the `bytes_to_long` function to convert the flag variable from bytes to an `int`. It then uses the `pow` function to encrypt this integer using the two RSA keys. The resulting ciphertexts are stored in variables named `c1` and `c2`. Finally, the script writes the ciphertext to a file named `ciphers`. Pretty simple right?

In the challenge description, it is stated that the public keys have the same modulus. Therefore, it can be determined that to obtain the flag, one needs to perform an attack on the RSA key using the `Common Modulus Attack`

Im using [X-RSA](https://github.com/X-Vector/X-RSA) instead of `RsaCtfTool` because that tool is broken on my machine. And voilÃ  you will get the flag by choosing `Common Modulus` option


[Image extracted text: Version
0.4 ]
Author
X-Vector
Github
github _
com/X-Vector
Twitter
twitter
com/@XVector11
Facebook:
facebook-com/X.Vector1
Greetez
Karem Ali
7>
1988514743771657180281129728422656392152063488770166086226273111710422099637028357696143383988474553639468630827621732363735022238028472445577693091520207193770093436780963237672555451337343929812728352
125453534887151101564277111115257435854807586400093195053223158880051882769049010232806200515380537439296691677958508603355497689691664615939062393573723305054339461297170418344757323726709610260014782272549992
3718196250867204510681064391880099449164629711720021122445665846890550815079811041241824128791656795460007230003283109669795738520458565694688073372232365469969279979269172335621053156518588065204669164636568515
5859680887152992216160984481968350074860263068345858573853943799325808092031030231062294247206600966615859326121794719866337212313967641566018452624790144172018667037968060224793956940338157884467951586054787442
3467943892121948270932185986128898815622456339941313421809201621614731395832713150790143371905487427516065155685618338049215174651005273024268587461876135521598437626571971547336347698695790144531550409271949983
841738132561701536929349193013330763012886505135750096015051895475085650750136655306242071946469240453847213789244367919852654175448332490327597082009088460241027864478139929
682978387326
7>
5419401098361253338957814301048859674850134622383574257093539440754283042121816133463421688336329157718503177060815824137507507197128280616692518364675131168154963990774355725148638134198201776957161224
3317680552853253518840372673276791469208856312164040
878586264559446821
546534772108301710564728056340296951876580819049594989246375314804023460418349786916821313444113425159193390713546333665402922306599887755
726947547017980419563903548192837655003937747396055878826931043131382588898890866019130231138584664172370209308699613897125864083606128589397004152055224497792964548397729060224127658413608898490744119312940923
71066258484311880180045793416943812191025236243471619
064236551302755562358860534549136237814085075287652312464795604230258140
6523484680324312672253996151689228852912363011517239963699778452230209760256687673
461396885113448685839175215591622971347192741025539479046037845006380335795302337211393198858757675604346668444236529860659918554664995434965926866275091837660919174027474686650629143226310338907428285119150461
16469857933010318728227090605885867735525816444185533833142632
0860241588098545681894182356630
0035600457464233007552461215491869285368208456103672933515573777187729174614608959934215
7>
1468141368885347405046385442268050374560151083622561942421682968664483199756073950463553647143554002617376526609498238066325099676714787068533261033897391823339143660450052176894691470253965943715034058
8502298388665736059548660880
430155056022849427139085128534471595882441898166134489193831262701039440615430362289384203
886496
04706563
0089898365789370149897194773856872418060715172432523663835984638773401
675046677965187768921877780241225304167706013426964164784892089052331053222039853063451013348800390969425843136138759977415462705911901060038902204403971946097759679518105450993734613295301947433304253495502226
6507525146834954003294764365506192235076400615615586863042804990381216753553451961669135359644592356296170712005
058091232
019
8226501685584833391761843170280
3066519696640085001933820797422907808916301970582519
4821110485442083185859843020488289097213380114786205591198329031639647388382196002386424092103019202707023574648989871997705524540782749023459219761470978887482321345861668746378119080378556236405340671487411772
292305883894667308145288780722021391737530429913675290799741861282570363896989525162785858989052641779664605429674577
68840264473377422535491893749138206714686425874967632530058787-
7>
e2
4299291470698031922679235679277305959761208663683774820879128945888088980142641026279094580063688599490844929295732481969575593479769804218178337547187423285749799787836728589226426905872074107371305971
15280974567065658152285208418630469661393810671225102398980769421
641105695940966163345181407140997453894109278221816620432011760258951915921290213934331553593789837052451252835992069581430826412226830319864810
771278317022100663722534328899834974377275406199764474054850259024321032175019032030498694062856115751394226081726653327907314810357795552230439574755170760819307529287253005129741499268698505423519752785605487
1277740850968017495893265933269881217727318849
060
800487420094055784383890976936096305189319136615912189056093546201607344249641942512167550589817415140816437582524526583415109197243681779
003065425264549026583
0227283320815607740515552799838107781922128570170543235597743296103248573241018111438772014492763795631809044509801709006234474441581352627014998235245488087233641356227803268018574465264778320058129983497590388
6218101553288715929775744704284929269570386451876220679048241
94185835403625553
669800793823359495
8890243500128461020612060136743357401235487242852032777
1696313582787371340
091342784407
7>
666019644603343705828097204972657484510063196990065863079854826838552353191662312548413423916718570288463249009959
5944802079993806061228282733237497922175263004540662943884746280459202161922847382131209
1626950670743385937523802723727823144825989123088127973484983713003742558456811766955261089357983267112480
6065627097313747250837107667876779263665093620445261673412262983695447560728273021520313588386547052905
51236668819820269755205493304876705186652376122667813834833595966411017789775204429651355139518880131162241659217988127720842793716488048764946575607
607616876204816536912951273330695362953158205592577548646560
5148058647049834332734203175036759006775408097241958715649535761238
0327807412239592099923554314784853309021255212036591757692948375799847738014847307483510444256112430753072077674049188297255739048422268821614
625215683879739715758528230601094346279730506561983338838583088219627494212799403779141439489816823157152277432858802920685064665657369089299717842242840993101575345885688905226546872946841080492529221459675330
92676387570745058755496838841792180673970099
0694368861589657493383608588944365660068895303145970199148057362346803487
8491483668865831573495043565665576153321929933162287499448525738377
PlainText
in Decimal
111370287864635821706296037246499291051391219732330206848771965
PlainText
in hex
454e4f7b35686172316e675f69735f6e30745f633472316e677d
PlainText
in
ascii
ENO{SharIng
is_nOt
cArlng}]


```
ENO{5har1ng_is_n0t_c4r1ng}
```