# Who the Hack
> ---------- Email ----------

> Subject: URGENT! Anomali Sistem From: farel@halubank.local To: itsec+dfir@halubank.local <2023-08-12 19:46:26>

> Dear Tim IT Security,

> Tim monitoring mendapati bahwa sistem aplikasi mengalami down saat jam makan siang tadi, namun hanya beberapa menit saja. Berikut ini saya lampirkan access.log dari server terkait, mohon untuk diperiksa segera, apakah ada anomali yang terjadi atau tidak.

> Terima kasih.

## About the Challenge
Given a ZIP file containing server logs from a website. There are 39,099 lines in this log, and the log covers timestamps from August 8, 2023, to August 14, 2023. (You can download the file [here](access.zip))


[Image extracted text: Joeoj
Cau
Knummad Dala
OcCtc
Dooumtis 
19-156-169 ,
[0x Un7073 8o20dJc
Jo7cai
Afatecre
HTTPTI-I" 703
FAleWeanalet
hotilia 5
"Lina
Androld 8 [0
ASUS_Xeald Bufld/0eNI.171019.011;
Faalek Uitt537.4
JCHIUL
Hanelaeeeen
[UB AURZuditouid
Mar
cachbertthnancrt
la
Kledd
Fenteen
Hlnas
ndntit
culldcKeuSbeie
Huainpie cbtisd
ICHICL;
Jaea1aa a
LobaUn7073!0o,0d.45
Laraa
aeneesbootattan.
Hnprii
Tnetps doocleco
arillas
ndetid
Bulld RP SJI.07-58-B7edeiI)
Applclcbi
AAAsase
TobaUn707! Eo.01.1
407eOi
Jdashboardnocout HTIPTIle
Fhotillars Btlin;
Hnanod
Hhannen
colen DdsJe
WHTkL; Jic Gcko)
SuerlncuccuechzlE
CnrotFlle
8g16
[48/un70ii0odi;is
4o7oai
Adnihtaardrerin HTTRIale
Fotiias
Tlinua
Android Ia
5n-ns3g8
Bullonrina770ra,Cia
acplertrin577,36
achrL
Gttol
Uertlcnna;
195-114
Teb AL ZErlCo-0l.75
Jo7eol
Acanboanut tnanatet
HP/i.]" 200 479
-Koillla
Tnindons
acplenbrtS
TCkL
Gecko)
Cnrortrds D-zas0s Gatacitsjiis
Hef unnaaal
Hatd
cthl
Hinte
Fuo.illo5
Celmnaa
Hcnad
An
Hunana e taananena
Hetelnnan
Hnhn
Kefed
Hnnte
Hlelely
Teb AUnZutCo-0z Zs
Ciia
Whaen Ha
Fhttoni/atchttn
Fannaelelea
unnoid
Hulld OODJO-Z8u2 192195
nneebaeeet
HaleGnc
Haldea
Teb AURZu coozi4
Mlia
Whan
Hd
Fhttps accboorcon
Fatneelen
(Linu
unnoidAeaecEHec
HuednaemieHde
Applencb itSJu
K
Heeaoa
Laeede
108/4Un7073400207 45
ada
Jacarchenteolidddcodn HitTpfI
-ntenaehiterreron
Vorilins
dt
Ean
Sh_aroegradeCOSSDB]
AcplaEritsr
dJelo sglla
[@B Aun loico0z 54
Jo7cji
Vdathboard branche
Hnp/1.1" 200 760
otilla 5 0 urdon
5.1) Acplcr671t/537.36
hhtki
Getrol
Inror7ds 0a2ds 485 Gatori 53ielo
eaaaat
HUCEEreaearbatee
HoTEa
Lashbi
Ha
Andriiana
FLLMsa
Aencic
IkGtle
KpplcUcbrit 537-6
Hnhntl
Hn rcid
Aaai
chacetal
F10s-19i
An7E7N88203 BI
Jo7eol
Yutnb
HTPTI
788 695
Fhlrog#Radnnia
Florilla s
ALiEe
android 172
Hulld 5155517-5]-S5-4e2
Applccbif
ALUBZueitornzina
Hanla
AeeieHanm
Aninntnnanetc
Aainenea
Hlntn=
Hdnand
Aeto Ed)
HaedAfnna
Appettat5n
IhIE
LedeetE
Tob aUnZ0ZI C0-0jiJs
arAA
Jecarchroro otioncocod? Hipfll
nttps:/ Rccclc co
Feuni aean
androld 1;
HEmeen
colcr btltt
Mnlnm
Grco
136.131.83,78
[08/un701i0nr0i56
4a7oai
Honinboand Aeaint _
Hpai
heertancn-hlulank-lact
Fotills0
(Lins
drald
roto E(9) Play
Bul ld RF957io7-58-17-7-38
cplert
o corea D
Jo7eol
HITP
AhitnseAHImcr
Hozllla 5 E
{Limd
Indrold 1J2
Gov uild WCl Arue-Oldn
appleacbrit 5JT
(utt
ccho
IS5a21.15
[eb Aun zoced Ji
Jo7ci
Acctoia
HTP-1
Morilla 5a0
(Linux;
Andccle
DLalt
Lulld HLALICLL;
acolenctrit SJG (HMAL
licc Gcro]
Ucrslonia 0 Chr
HeA uneeeaeaeba
Hared
Lathbae
Elata
Und HTTPAI
Aidni els
unod
FSe
Auiadam
Hlealz E46s
Hntanirieesee
H
Hent
Aatue endd
[UB AURZusicobsiLe
Mar
Hniefe
HN
LAAGad
hitnae/atenttenCo
Annelenn
Hlmne
rarnoim
Aean
cnme trand=
neaetatEceh
HeleGnct
FEGAifn7a7
108aUn7073!00205.74
407091
Jacarchertoticcdcodn HitpfI
ntepenfnc boulacon
Tarilln5-0
detid
Eaie
Build Fr0i.711nn9-881
RpplcucbrIt,537-15
194.1562169,
[@4B un203i0or05 JC
Jo7cai
Vdathboardrealn HTNe
Fotllasad
Tlinu; Androld  8]
HceMan
Bulloron 171cist
Applerctrt 537
(KHTT
ectol
olazual,7ds
[48/un7017i07305;47
Jo7oai
Adnihboardrroecnt
HnP/1.1" 200 103
TOta 5 ,
Jurao
Huot
Koplek 001tt537.36 (KhiNL
Geckor
Cnrorn 55.0,2926,68 5.f4175j7,362
HEld AUcnrereieaebdtbi
HonEA
Adashboand subalt HTTPFI
2 1M
hozillar5
Hainoch
cune
HcolenbritSJi
A
Iiad DAEAd
nnoeie
Fatdciea
Hfe tnentee
HeA Lrnaaalnai
Haad
Hdnthbannanlarin HTTDAR Jo
Anaeleen
Hlntnze
Jccd
onaicer
Ru fldfToiidia Rua
coleatkit/57736 Aah
AWmae
Cetat
EEE
Teb aUnZuco-ed Z9
Ciia
dachboard chanae passlord Hupaile
Snnelelnne
Andemiid
H  nlnnnnted-
acplencbtitee
Mei
Gcto)
Mlicut
TLjrd
aiennt
Coou
TLint
Tlcua}
Vlite
Coo
Mticuta]


## How to Solve?
The first thing I did was to search for any suspicious requests, such as hacking attempts or random requests. In the log, I found 1 IP address, which is `178.19.45.123`, that seems to be involved in hacking attempts.


[Image extracted text: 178.19.45.123
[11/Aug/2023:12:00:15 +0700]
'GET
env
HTTP/1.1" 403 858
curl/7.88.1"
45.123
[11/Aug/2023:12:08:16 +8780]
'GET /. aletc/passwd HTTP/1.1"
403 539
"curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:17 +8780]
'GET /Vagrantfile HTTP/I.1"
403 608
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:00:19 +0700]
'GET / git/config HTTP/1.1"
403 855
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:00:21 +8700]
GET / ILEB-INF /web.xml HITP/1.1" 403 647
curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:00:23
+0700]
GET
phpmyadmin/ index-php HTTP/1.1"
403 874
"curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:08:24 +8780]
'GET
chtaccess HTTP/1.1"
403 835
88.1"
178.19.45.123
[11/Aug/2023:12:00:26 +0700]
GET
Store HTTP/1.1"
403 519
curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:00:28 +0780]
GET
~github/workflows/build yaml HITP/I.1"
403 273
"curl/7.88_
178.19.45.123
[11/4ug/2023:12:00:29
+0700]
GET
aws/config-yanl HTTP/1.1
403
180
curl/7.88.1"
178.19.45.123
[11/Aug/2823:12:00:31
+8780]
GET /info-php HTTP/1.1"
403 415
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:32
+0700]
GET /phpinfo.php HTTP/1.1" 403 961
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:00:34 +0780]
GET
htaccess HTTP/1.1"
403 249
88.1"
178.19.45.123
[11/Aug/2023:12:08:36 +0700]
'GET /download php?file../.
-  letc /passwd HTTP/I.1" 403 386
178.19.45.123
[11/Aug/2023:12:00:37
+8700]
'GET
~ssh/id_rsa HTTP/I.1" 403 165
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:39 +0780]
GET /.travis.yml HTTP/I.1"
403
curl/7.88.1
178.19.45.123
[11/4ug/2023:12:00:41 +0780]
GET
-travis
Skp HTP/1.1" 403 825
"curl/7.88.1'
178.19.45.123
[11/Aug/2023:12:08:43
+8700]
'GET
ctravis yml~ HITP/I.1" 403 568
curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:00:44
+0700]
GET /remotelfgt_lang?lang-/  lIdev/cndblsslvpn_websession HT
178.19.45.123
[11/Aug/2023:12:00:46 +0700]
'GET
config-php
HTTP/1.1" 403 728
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08
0700]
GET /. /etc/passwd HITP/1.1" 403 687
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:48 +8780]
GET /../  .letc/passwd HTTP/1.1" 403
435
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:49 +0780]
GET
letc/passwd HTTP/1.1"
403 890
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:08:50 +0780]
'GET /  aletc/passwd HTTP/1.1
403 262
curl/7.88.1'
178.19.45.123
[11/4ug/2023:12:00:51 +0780]
GET
letc/passwd HTTP/1.1" 403 101
curl/7.88.1'
178.19.45.123
[11/Aug/2023:12:00:53 +0700]
'GET /posts/1*27+OR+SLEEPI28999*29+-
HTTP/1.1" 403 994
curl/
178.19.45.123
[11/4ug/2023:12:00:54 +0700]
'GET /*60whoami360 HTTP/1.1" 403 446
curl/7.88.1"
178.19.45.123
[11/Aug/2823:12:00:56 +8780]
GET /*60id760 HTTP/1.1" 403 546
curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:00:57
+0700]
GET /x68pwdz6e HTTP/1.1"
403 253
curl/7.88.1"
178.19.45.123
[11/Aug/2023:12:00:58 +8700]
GET /*6015760 HTTP/1.1"
403 109
curl/7.88.1"
178.19.45.123
[11/4ug/2023:12:01:80 +0700]
GET /*60uname360 HTTP/1.1"
403 283
curl/7.88.1"
178.19.45.123
[11/Aug/2823:12.:01.01
+8700]
GET /posts/1827+0R+1-1+--+-+ HITP/I.1" 403
633
curl/7.88.1"
178.10.45.173
Ean
39072e17.9ican
oa7oat
GFT
Cincin
TiDJLORDFR_RYA1
HTTPT1
493 765
"cnl7 88
178.19.
curl/7
7.DS
curl/7
Yal_]



[Image extracted text: 178.19.45.123
Aa @be*
60 of 121
1 = *]


Upon further investigation, this IP address made 121 requests to the web server. After the 60th request, the IP initiated a peculiar request by inputting a percent character followed by two characters.


[Image extracted text: 193
6/.136.52.134
111/Aug/ 2023:18:59.38 +0/00]
FGE!
Tsearcni bankoozuaccou
194
217.112.15.97
[11/Aug/2023:19:00:04 +0700]
"GET
HTTP/1.1" 200 809
195
178.19.45.123
[11/Aug/2023:19:00:05 +0700]
"GET /930 HTTP/1.1"
404
196
229.239.15.87
[11/Aug/2023:19:00:17 +0700]
"POST /dashboard/login HT
197
155.21.25.104
[11/Aug/2023:19:00:23 +0700] "GET /favicon-ico HTTP/1 _]


If we extract the suspicious requests using `cat` and `grep`, the command might look like this:

```bash
cat access.log  | grep "/%.*{2} HTTP" -Eo
```

Then a list of requests will appear as shown in the image below


[Image extracted text: /830 HTTP
/862
HTTP
/979
HTTP
/874
HTTP
/965
HTTP
/943 HTTP
/954 HTTP
/846 HTTP
/87B HTTP
/957
HTTP
/933
HTTP]


Input the list of requests into CyberChef, then convert from hex to ASCII, and you should obtain a flag.


[Image extracted text: cipe
Input
/*54 HTTP
om Hex
/*68 HTTP
Delimiter
/*34 HTTP
Auto
/S6E  HTTP
/SSF HTTP
/331 HTTP
/S6E   HTTP
(SSF HTTP
/352 HTTP
(333 HTTP
(334 HTTP
(36C HTTPc
/431
HTTP
(374 HTTPcr
/*79 HTTP
(X7D  HTTP
Output
ebyteCTF{W3_Suff3r_MOr3_Oft3n_In_lnaglnatlOn_Than_In_R34llty}]


```
0byteCTF{W3_Suff3r_M0r3_0ft3n_1n_1m4g1n4t10n_Th4n_1n_R34l1ty}
```