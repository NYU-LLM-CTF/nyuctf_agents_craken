# Illusion
> Good Luck

## About the Challenge
We have a pcapng file that contains numerous HTTP requests. (You can download the pcapng file [here](traffic.pcapng))


[Image extracted text: No:
Time
Source
Destination
Protocol
Lengtl | Leftover Capt| Info
448
2024-01-14
13:43:11.873271
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
456
2024-01-14
13.43.17, 919659
70,0,2,15
52,15,.122. 56
HTTP
248
GET
HTTPT1,1
728
2024-01-14
13:43:18. 159260
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 Ok
(text/htmt)
762
2024-01-14
13:43:20.203505
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
1034
2024-01-14
13:43:20.453453
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1
200
OK
(text/html)
1042
2024-01-14
13:43:24.499686
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
1314
2024-01-14
13:43:24.713213
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
1322
2024-01-14
13:43:27 . 752582
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
1594
2024-01-14
13:43:27.990157
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
1602
2024-01-14
13:43:31.045195
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
1874
2024-01-14
13:43:31.265050
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
1882
2024-01-14
13:43:38.298321
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
2154
2024-01-14
13:43:38.539061
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200
OK
(text/html)
2162
2024-01-14
13:43:38.616477
10.0.2.15
52.15.122.56
HTTP
464
GET
'images?guid-ajcrTlpmTC9kMy8xNkRXQzFvdStUWFoSZVVIOTgyMDduVORIdWJoemdRUTNSOXFIQZN
2164
2024-01-14
13:43:38.666544
52.15.122.56
10.0.2.15
HTTP
251
HTTP/1.1 200 OK
2176
2024-01-14
13:43:45.722107
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
2448
2024-01-14
13:43:45.934498
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
2456
2024-01-14
13:43:47.984952
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
2728
2024-01-14
13:43:48.199401
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200 OK
(text/html)
2738
2024-01-14
13:43:53.249422
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
3010
2024-01-14
13:43:53.487022
52.15.122.56
10.0.2.15
HTTP
1349
HTTP/1.1 200
OK
(text/html)
3018
2024-01-14
13:43:59.533346
10.0.2.15
52.15.122.56
HTTP
248
GET
HTTP/1.1
3200
2024-01_14
13.43.50777260
52 15 122
56
10
15
1 340
HTTP
200
OK
(text/ht]


## How to Solve?
There are endpoint `/images?guid` endpoint with blank response and in the `/` endpoint contain google search HTML code


[Image extracted text: GET
HTTP/1.1
Juser-Agent:
Mozilla/5.0
(Windows
NT
6.3;
Trident/7.0;
rv:11.0)
like
Gecko
Accept-Encoding: identity
Host:
52.15.122.56/
Cookie:
sessionid-jgedmupPJddStNI
Connection:
Closel
HTTP/1.1
200 OK
Server:
IISI
lContent-Type:
text/html;
charset-UTF-8
Date:
Sun
14
Jan
2024
13:43:17
GMT
Etag:
"2cf9320f5286afaff567ddbac7cf96fb40b404ed
IContent-Length:
261733
Connection:
closel
k!
doctype htmt <htm
itemscope=
itemtype-"http: //schema.org/WebPage
lang="en"><headz<meta
content-"IE-edge"
http-equiv-"X-UA-Compatible"><meta http-equiv-"Content-Type
cont
lent="text/html;
charset-UTF-8"><meta
content="Search
the
world
5
information,
includ_
webpages ,
images_
videos
and
more. Google
has
many special features
to help you
find
exa
ctly
what
you
re
looking for_
name=
description"><meta
content="noodp"
name="robots"><meta
content="text/html;
charset-UTF-8"
http-equiv="Content-Type"><meta
content=" / images 
branding/googleg/1x/googleg_standard_color_128dp. png"
itemprop=" image"><title Google</titlezsscript
nonce="JE98fgfYyMg3iKWBWZIWXA"> ( function() {var _g-{kEI:
3eSjZc3DDf2JptQPjtofl
IgAY =
kEXPI:
0,798230, 3, 562886,4348,207,2414,2390,1132070,870537,327189,675,380089, 16112,28685,1114,22680,12317,17590,4990,17075,38444,2872,2891,3926, 7828,606,29842,826,30022,63
97,8927, 781,1244,1,16916,2652,4,59617,2980,24058,6636,7596,1,42157,2,16392,342,21266,1758,5679,1021,31121,4568, 6256,23422, 1251,33064,2,2,1,24626,2006,8155,23351,20506,6,1923, 97
79,5864, 36595,3141,17058,6049, 14101,82,16514,3801,2412,1548,28671,3030,15816, 1804,7734,6072,12026,575,7220,1641,11814,1635,8839,4654, 9368,28195,5303,5210139,2,225,1361,5993379_
2806666 , 7475465,19266065, 1290612,43886,3, 1603,3,262,3,234,3,2121277,2584,22636438,392913,4126,4037,4636,8409,8027,6514,2124,13022,3608,820,1224,9352,3478,2400,23387, 1718,2 , 5885
9210,2,1291,2,6,1123,929,27,6,5,15,265,1390,3442,703,662,210,436,2436,92,1146,1230,6231,1,1994,230,50,884,2379,4,4285,605,2134,3913,107,853,149,106,1353,612,976,1611,552,1,6,2
1602,214,389,1978,2,1765,3782,218,3,311,1838, 166,310,2271,210,1130,3367,4,132,2032,88,175,897, 1068, 16,600 
1,6,2517,1303,1,162,2116,253,1336,895,291,1,67,93,880,591,281,841,638,5
103,1350,1425,1317,3,1315,308,12, 147,1196,600,722,585,4,100,68, 1,366,236,766,13,317,2,2,1001,332,13,2,820,1,1,50,2,571,253,440,442,257,590,215,568,349,1262,388, 1754,6,197,352,20
52,646,104,334,8,121,329,14,3118,106 ,
1,116,131,1,376,297,1010,4,179,269,1,505,1,6,33,3152,980,3,233, 722,481,51,804,879,46,37,74,76,32,1,1,1,335,163,324,1,13,60,241,742,415,394_
226,166,60,1161,119,1,1,1,254,17,1252,482,81,1,3,21300484,421028,728,218, 1620,3,2662,502,711
kBL:
NntB
kOPI:89978449};
function( ) {var
a; (null--(a-window-google) ?0:a.stvsc) ?go
loq le.kEI=
0.kEI:window_aooale= 0;})  call(this);}) ();
function( ) {aooale.sn=
webhp
aooale.kHL='en';}) () ; ( function( ) {L
ing]



[Image extracted text: GGET
images?guid-ajcrTIpmTC9kMy8xNkRXQZFvdStUWFoSZVV OTgYMDduVORIdWJoemdRUTNSOXFIQZNXYZVKOFhKMBFORGRKQLdTVkgzYWIRYKZSckdHNVZtOGs4SXNKZEdpaHhVeGRZaFdYBdLMUFGRjZOM FRc2trYkdjZFYr
b1RLR3ZPbZpuQUEzTUpLakRQd1FLREg1Z FZdmp3PTO=
HTTP/1.1
User-Agent:
Mozilla/5.0
(Windows
NT 6.3;
Trident/7.0;
rv : 11.0)
like
Gecko
Accept-Encoding:
identity
Host:
52.15.122.56
Cookie:
sessionid-jgedmupPJddStNI
IConnection:
Closel
HTTP/1.1
200 OK
Server:
IIS
IContent-Type
text/html;
charset-UTF-8
Date
Sun,
14
Jan
2024
13:43:28
GMT
"da39a3ee5e6b4b0d3255bfef95601890afd80709
Icontent-Length:
0
Connection:
close
EEtag:]


And then I tried to search on GitHub about `/images?guid` endpoint and I found this [code](https://github.com/gsmith257-cyber/RandomTools/blob/b81d696ea4ddaafd045acd94ecc07302946d2c6d/trevorC2Decrypt.py#L51). Use the TrevorC2 traffic decryptor to decrypt the traffic, here is the output after decrypting the traffic

```
WARNING: No IPv4 address found on anpi1 !
WARNING: No IPv4 address found on anpi0 !
WARNING: more No IPv4 address found on en3 !
Decrypted response: magic_hostname=WINDOWS
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: WINDOWS::::pwd
Decrypted response: WINDOWS::::
Path                    
----                    
C:\Users\analyst\Desktop



Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: WINDOWS::::curl https://uoftctf.org
Decrypted response: WINDOWS::::curl : The response content cannot be parsed because the Internet Explorer engine is not available, or Internet 
Explorer's first-launch configuration is not complete. Specify the UseBasicParsing parameter and try again. 
At line:1 char:2
+  curl https://uoftctf.org
+  ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotImplemented: (:) [Invoke-WebRequest], NotSupportedException
    + FullyQualifiedErrorId : WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestComman 
   d
 

Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: WINDOWS::::cd ..
Decrypted response: WINDOWS::::
Decrypted command: WINDOWS::::pwd
Decrypted response: WINDOWS::::
Path            
----            
C:\Users\analyst



Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: WINDOWS::::cd Desktop
Decrypted response: WINDOWS::::
Decrypted command: nothing
Decrypted command: WINDOWS::::New-Item "flag.txt"
Decrypted response: WINDOWS::::

    Directory: C:\Users\analyst\Desktop


Mode                 LastWriteTime         Length Name                                                                 
----                 -------------         ------ ----                                                                 
-a----         1/14/2024   8:44 AM              0 flag.txt                                                             



Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: WINDOWS::::echo "uoftctf{Tr3V0r_C2_1s_H4rd_T0_D3t3c7}" > flag.txt
Decrypted response: WINDOWS::::
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
Decrypted command: nothing
```

## Flag
```
uoftctf{Tr3V0r_C2_1s_H4rd_T0_D3t3c7}
```